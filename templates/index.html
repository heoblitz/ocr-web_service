<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>OCR-web_service</title>
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <style>
        .wrap {
            margin: 0 auto;
        }
        .content {
            outline: 2px dashed #92b0b3 ;
            outline-offset:-10px;  
            text-align: center;
            transition: all .15s ease-in-out;
            width: 300px;
            height: 300px;
            background-color: gray;
        }
        .content img, .content video {
            width:100%;
            height:100%;
            display:none;
        }       
    </style>
</head>
<body>
    <div class="wrap">
        <p>OCR-web_service</p>
        <div class="content">
        </div>
        <a class="ui-shadow ui-btn ui-corner-all" href="javascript:uploadServer();">전송</a>
    </div>
    <script>
        $('.content')
        .on("dragover", dragOver)
        .on("dragleave", dragOver)
        .on("drop", uploadFiles);
        var IMG;
        var FILE;

        function dragOver(e){
        	e.stopPropagation();
        	e.preventDefault();
        	if (e.type == "dragover") {
        		$(e.target).css({
        			"background-color": "black",
        			"outline-offset": "-20px"
        		});
        	} else {
            	$(e.target).css({
        			"background-color": "gray",
        			"outline-offset": "-10px"
        		});
            }
        }

        function uploadFiles(e) {
            e.stopPropagation();
            e.preventDefault();
            dragOver(e);
        
            e.dataTransfer = e.originalEvent.dataTransfer;
            var files = e.target.files || e.dataTransfer.files;
            if (files.length > 1) {
                alert('하나만 올려라.');
                return;
            }
            console.log(files[0]);
            if (files[0].type.match(/image.*/)) {
                FILE = files[0];
                IMG = window.URL.createObjectURL(files[0]);
                    $(e.target).css({
                    "background-image": "url(" + IMG + ")",
                    "outline": "none",
                    "background-size": "cover"
                    //"background-size": "cover"
                    //"background-size": "300px 300px"
                });
            }
            else{
              alert('이미지가 아닙니다.');
              return;
            }
        }

        function uploadServer(){
                //var form = FILE;
                var formData = new FormData();
                formData.append("file", FILE);
                $.ajax({
                    url: '/upload',
                            processData: false,
                            contentType: false,
                            data: formData,
                            type: 'POST',
                            success: function(result){
                                alert("업로드 성공!!");
                            }
                    });
        }
    </script>
</body>
</html>